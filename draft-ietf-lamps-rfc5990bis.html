<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Use of the RSA-KEM Algorithm in the Cryptographic Message Syntax (CMS)</title>
<meta content="Russ Housley" name="author">
<meta content="Sean Turner" name="author">
<meta content="
       The RSA Key Encapsulation Mechanism (RSA-KEM) Algorithm is a one-pass
(store-and-forward) cryptographic mechanism for an originator to securely
send keying material to a recipient using the recipient's RSA public key.
The RSA-KEM Algorithm is specified in Clause 11.5 of ISO/IEC: 18033-2:2006.
This document specifies the conventions for using the RSA-KEM Algorithm as a
standalone KEM algorithm and the conventions for using the RSA-KEM Algorithm
with the Cryptographic Message Syntax (CMS) using KEMRecipientInfo as
specified in draft-ietf-lamps-cms-kemri. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="Key Encapsulation Mechanism (KEM)" name="keyword">
<meta content="KEMRecipientInfo" name="keyword">
<meta content="draft-ietf-lamps-rfc5990bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.11.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-lamps-rfc5990bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RSA-KEM with CMS KEMRecipientInfo</td>
<td class="right">April 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Housley &amp; Turner</td>
<td class="center">Expires 25 October 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Limited Additional Mechanisms for PKIX and SMIME</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lamps-rfc5990bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc5990" class="eref">5990</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-04-23" class="published">23 April 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-10-25">25 October 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Housley</div>
<div class="org">Vigil Security</div>
</div>
<div class="author">
      <div class="author-name">S. Turner</div>
<div class="org">sn3rd</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Use of the RSA-KEM Algorithm in the Cryptographic Message Syntax (CMS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The RSA Key Encapsulation Mechanism (RSA-KEM) Algorithm is a one-pass
(store-and-forward) cryptographic mechanism for an originator to securely
send keying material to a recipient using the recipient's RSA public key.
The RSA-KEM Algorithm is specified in Clause 11.5 of ISO/IEC: 18033-2:2006.
This document specifies the conventions for using the RSA-KEM Algorithm as a
standalone KEM algorithm and the conventions for using the RSA-KEM Algorithm
with the Cryptographic Message Syntax (CMS) using KEMRecipientInfo as
specified in draft-ietf-lamps-cms-kemri.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-rfc5990bis/">https://datatracker.ietf.org/doc/draft-ietf-lamps-rfc5990bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Limited Additional Mechanisms for PKIX and SMIME Working Group mailing list (<span><a href="mailto:spasm@ietf.org">mailto:spasm@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/spasm/">https://mailarchive.ietf.org/arch/browse/spasm/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/spasm/">https://www.ietf.org/mailman/listinfo/spasm/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 October 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-rsa-kem-algorithm-rationale" class="internal xref">RSA-KEM Algorithm Rationale</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-rsa-kem-algorithm-summary" class="internal xref">RSA-KEM Algorithm Summary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-cms-kemrecipientinfo-proces" class="internal xref">CMS KEMRecipientInfo Processing Summary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-asn1" class="internal xref">ASN.1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-changes-since-rfc-5990" class="internal xref">Changes Since RFC 5990</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-use-of-the-rsa-kem-algorith" class="internal xref">Use of the RSA-KEM Algorithm in CMS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-underlying-components" class="internal xref">Underlying Components</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-recipientinfo-conventions" class="internal xref">RecipientInfo Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-certificate-conventions" class="internal xref">Certificate Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-smimecapabilities-attribute" class="internal xref">SMIMECapabilities Attribute Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-rsa-kem-algorithm" class="internal xref">RSA-KEM Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-originators-operations-rsa-" class="internal xref">Originator's Operations: RSA-KEM Encapsulate()</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-recipients-operations-rsa-k" class="internal xref">Recipient's Operations: RSA-KEM Decapsulate()</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-asn1-syntax" class="internal xref">ASN.1 Syntax</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-underlying-components-2" class="internal xref">Underlying Components</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-smimecapabilities-examples" class="internal xref">SMIMECapabilities Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-rsa-kem-cms-enveloped-data-" class="internal xref">RSA-KEM CMS Enveloped-Data Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-originator-rsa-kem-encapsul" class="internal xref">Originator RSA-KEM Encapsulate() Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-originator-cms-processing" class="internal xref">Originator CMS Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-recipient-rsa-kem-decapsula" class="internal xref">Recipient RSA-KEM Decapsulate() Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#appendix-D.4" class="auto internal xref">D.4</a>.  <a href="#name-recipient-cms-processing" class="internal xref">Recipient CMS Processing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The RSA Key Encapsulation Mechanism (RSA-KEM) Algorithm is a one-pass
(store-and-forward) cryptographic mechanism for an originator to securely
send keying material to a recipient using the recipient's RSA public key.
The RSA-KEM Algorithm is specified in Clause 11.5 of <span>[<a href="#ISO18033-2" class="cite xref">ISO18033-2</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The RSA-KEM Algorithm takes a different approach than other RSA key
transport mechanisms <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, with goal of providing higher
security assurance while also satisfying the KEM interface.  The
RSA-KEM Algorithm encrypts a random integer with the recipient's
RSA public key, and derives a shared secret from the random integer. The
originator and recipient can derive a symmetric key from the shared
secret.  For example, a key-encryption key can be derived from the shared
secret to wrap a content-encryption key.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">In the Cryptographic Message Syntax (CMS) <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> using
KEMRecipientInfo <span>[<a href="#I-D.ietf-lamps-cms-kemri" class="cite xref">I-D.ietf-lamps-cms-kemri</a>]</span>, the shared secret value
is input to a key-derivation function to compute a key-encryption key, and
wrap a symmetric content-encryption key with the key-encryption key.  In
this way, the originator and the recipient end up with the same
content-encryption key.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">For completeness, a specification of the RSA-KEM Algorithm is given in
Appendix A of this document; ASN.1 syntax is given in Appendix B.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="rsa-kem-algorithm-rationale">
<section id="section-1.1">
        <h3 id="name-rsa-kem-algorithm-rationale">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-rsa-kem-algorithm-rationale" class="section-name selfRef">RSA-KEM Algorithm Rationale</a>
        </h3>
<p id="section-1.1-1">The RSA-KEM Algorithm provides higher security assurance than other
variants of the RSA cryptosystem for two reasons.  First, the input to the
underlying RSA operation is a string-encoded random integer between 0 and n-1,
where n is the RSA modulus, so it does not have any structure that could be
exploited by an adversary.  Second, the input is independent of the keying
material so the result of the RSA decryption operation is not directly
available to an adversary.  As a result, the RSA-KEM Algorithm enjoys a
"tight" security proof in the random oracle model.  (In other padding
schemes, such as PKCS #1 v1.5 <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, the input has structure and/or
depends on the keying material, and the provable security assurances are not
as strong.)<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The approach is also architecturally convenient because the
public-key operations are separate from the symmetric operations on the
keying material.  Another benefit is that the length of the keying material
is determined by the symmetric algorithms, not the size of the RSA modulus.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rsa-kem-algorithm-summary">
<section id="section-1.2">
        <h3 id="name-rsa-kem-algorithm-summary">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-rsa-kem-algorithm-summary" class="section-name selfRef">RSA-KEM Algorithm Summary</a>
        </h3>
<p id="section-1.2-1">All KEM algorithms provide three functions: KeyGen(), Encapsulate(),
and Decapsulate().<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">The following summarizes these three functions for RSA-KEM:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">KeyGen() -&gt; (pk, sk):<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-4.1">
            <p id="section-1.2-4.1.1">Generate the public key (pk) and a private key (sk) as described
in <span><a href="https://rfc-editor.org/rfc/rfc8017#section-3" class="relref">Section 3</a> of [<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.<a href="#section-1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-5">Encapsulate(pk) -&gt; (ct, SS):<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-6.1">
            <p id="section-1.2-6.1.1">Given the recipient's public key (pk), produce a ciphertext (ct) to be
passed to the recipient and a shared secret (SS) for use by the originator,
as follows:<a href="#section-1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-7.1">
            <p id="section-1.2-7.1.1">1. Generate a random integer z between 0 and n-1.<a href="#section-1.2-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-8.1">
            <p id="section-1.2-8.1.1">2. Encrypt the integer z with the recipient's RSA public key to obtain the ciphertext:<a href="#section-1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.2-9">
<pre>
       ct = z^e mod n
</pre><a href="#section-1.2-9" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-10.1">
            <p id="section-1.2-10.1.1">3. Derive a shared secret from the integer z:<a href="#section-1.2-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.2-11">
<pre>
       SS = KDF(z)
</pre><a href="#section-1.2-11" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-12.1">
            <p id="section-1.2-12.1.1">4. The ciphertext and the shared secret are returned by the function.  The
originator sends the ciphertext to the recipient.<a href="#section-1.2-12.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-13">Decapsulate(sk, ct) -&gt; SS:<a href="#section-1.2-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-14.1">
            <p id="section-1.2-14.1.1">Given the private key (sk) and the ciphertext (ct), produce the
shared secret (SS) for the recipient as follows:<a href="#section-1.2-14.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-15.1">
            <p id="section-1.2-15.1.1">1. Decrypt the the ciphertext with the recipient's RSA private key
to obtain the random integer z:<a href="#section-1.2-15.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.2-16">
<pre>
       z = ct^d mod n
</pre><a href="#section-1.2-16" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-17.1">
            <p id="section-1.2-17.1.1">2. Derive a shared secret from the integer z:<a href="#section-1.2-17.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.2-18">
<pre>
       SS = KDF(z)
</pre><a href="#section-1.2-18" class="pilcrow">¶</a>
</div>
<p id="section-1.2-19">3. The shared secret is returned by the function.<a href="#section-1.2-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cms-kemrecipientinfo-processing-summary">
<section id="section-1.3">
        <h3 id="name-cms-kemrecipientinfo-proces">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-cms-kemrecipientinfo-proces" class="section-name selfRef">CMS KEMRecipientInfo Processing Summary</a>
        </h3>
<p id="section-1.3-1">To support the RSA-KEM algorithm, the CMS originator <span class="bcp14">MUST</span> implement
Encapsulate().<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Given a content-encryption key CEK, the RSA-KEM Algorithm processing by the
originator to produce the values that are carried in the CMS KEMRecipientInfo
can be summarized as:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-3.1">
            <p id="section-1.3-3.1.1">1.  Obtain the shared secret using the Encapsulate() function of the
RSA-KEM algorithm and the recipient's RSA public key:<a href="#section-1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.3-4">
<pre>
       (ct, SS) = Encapsulate(pk)
</pre><a href="#section-1.3-4" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-5.1">
            <p id="section-1.3-5.1.1">2. Derive a key-encryption key KEK from the shared secret:<a href="#section-1.3-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.3-6">
<pre>
       KEK = KDF(SS)
</pre><a href="#section-1.3-6" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-7.1">
            <p id="section-1.3-7.1.1">3.  Wrap the CEK with the KEK to obtain wrapped keying material WK:<a href="#section-1.3-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.3-8">
<pre>
       WK = WRAP(KEK, CEK)
</pre><a href="#section-1.3-8" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-9.1">
            <p id="section-1.3-9.1.1">4. The originator sends the ciphertext and WK to the recipient in the CMS
KEMRecipientInfo structure.<a href="#section-1.3-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.3-10">To support the RSA-KEM algorithm, the CMS recipient <span class="bcp14">MUST</span> implement
Decapsulate().<a href="#section-1.3-10" class="pilcrow">¶</a></p>
<p id="section-1.3-11">The RSA-KEM algorithm recipient processing of the values obtained from the
KEMRecipientInfo structure can be summarized as:<a href="#section-1.3-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-12.1">
            <p id="section-1.3-12.1.1">1.  Obtain the shared secret using the Decapsulate() function of the
RSA-KEM algorithm and the recipient's RSA private key:<a href="#section-1.3-12.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.3-13">
<pre>
       SS = Decapsulate(sk, ct)
</pre><a href="#section-1.3-13" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-14.1">
            <p id="section-1.3-14.1.1">2. Derive a key-encryption key KEK from the shared secret:<a href="#section-1.3-14.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.3-15">
<pre>
       KEK = KDF(SS)
</pre><a href="#section-1.3-15" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.3-16.1">
            <p id="section-1.3-16.1.1">3.  Unwrap the WK with the KEK to obtain content-encryption key CEK:<a href="#section-1.3-16.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-1.3-17">
<pre>
       CEK = UNWRAP(KEK, WK)
</pre><a href="#section-1.3-17" class="pilcrow">¶</a>
</div>
<p id="section-1.3-18">Note that the KDF used to process the KEMRecipientInfo structure <span class="bcp14">MAY</span> be
different from the KDF used to derive the shared secret in the RSA-KEM
algorithm.<a href="#section-1.3-18" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1.4">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.4-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="asn1">
<section id="section-1.5">
        <h3 id="name-asn1">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-asn1" class="section-name selfRef">ASN.1</a>
        </h3>
<p id="section-1.5-1">CMS values are generated using ASN.1 <span>[<a href="#X.680" class="cite xref">X.680</a>]</span>, which uses the Basic
Encoding Rules (BER) and the Distinguished Encoding Rules (DER) <span>[<a href="#X.690" class="cite xref">X.690</a>]</span>.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-since-rfc-5990">
<section id="section-1.6">
        <h3 id="name-changes-since-rfc-5990">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-changes-since-rfc-5990" class="section-name selfRef">Changes Since RFC 5990</a>
        </h3>
<p id="section-1.6-1">RFC 5990 <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span> specified the conventions for using the RSA-KEM Algorithm
in CMS as a key transport algorithm.  That is, it used KeyTransRecipientInfo <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>
for each recipient.  Since the publication of RFC 5990, a new KEMRecipientInfo
structure <span>[<a href="#I-D.ietf-lamps-cms-kemri" class="cite xref">I-D.ietf-lamps-cms-kemri</a>]</span> has been defined to support KEM
algorithms.  When the id-rsa-kem algorithm identifier appears in the
SubjectPublicKeyInfo field of a certificate, the complex parameter structure
defined in RFC 5990 can be omitted; however, the parameters are allowed for
backward compatibility.  Also, to avoid visual confusion with id-kem-rsa,
id-rsa-kem-spki is introduced as an alias for id-rsa-kem.<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<p id="section-1.6-2">RFC 5990 uses EK as the EncryptedKey, which is the concatenation of
the ciphertext C and the wrapped key WK, EK = (C || WK).  The use of EK was
necessary to align with the KeyTransRecipientInfo structure.  In this
document, the ciphertext and the wrapped key are sent in separate fields of
the KEMRecipientInfo structure.  In particular, the ciphertext is carried in
the kemct field, and wrapped key is carried in the encryptedKey
field.  See <a href="#app-alg" class="auto internal xref">Appendix A</a> for details about the computation of the ciphertext.<a href="#section-1.6-2" class="pilcrow">¶</a></p>
<p id="section-1.6-3">RFC 5990 includes support for Camellia and Triple-DES block ciphers;
discussion of these block ciphers is removed from this document, but
the algorithm identifiers remain in the ASN.1 Module <a href="#app-asn1-module" class="auto internal xref">Appendix B.2</a>.<a href="#section-1.6-3" class="pilcrow">¶</a></p>
<p id="section-1.6-4">RFC 5990 includes support for SHA-1 hash function; discussion of this
hash function is removed from this document, but the algorithm identifier
remains in the ASN.1 module <a href="#app-asn1-module" class="auto internal xref">Appendix B.2</a>.<a href="#section-1.6-4" class="pilcrow">¶</a></p>
<p id="section-1.6-5">RFC 5990 required support for the KDF3 key-derivation function <span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span>;
this document continues to require support for the KDF3 key-derivation function,
but it requires support for SHA-256 <span>[<a href="#SHS" class="cite xref">SHS</a>]</span> as the hash function.<a href="#section-1.6-5" class="pilcrow">¶</a></p>
<p id="section-1.6-6">RFC 5990 recommends support for alternatives to KDF3 and AES-Wrap-128;
this document simply states that other key-derivation functions and other
key-encryption algorithms <span class="bcp14">MAY</span> be supported.<a href="#section-1.6-6" class="pilcrow">¶</a></p>
<p id="section-1.6-7">RFC 5990 supports the future definition of additional KEM algorithms that
use RSA; this document supports only one, and it is identified by the
id-kem-rsa object identifier.<a href="#section-1.6-7" class="pilcrow">¶</a></p>
<p id="section-1.6-8">RFC 5990 includes an ASN.1 module; this document provides an alternative
ASN.1 module that follows the conventions established in <span>[<a href="#RFC5911" class="cite xref">RFC5911</a>]</span>,
<span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span>, and <span>[<a href="#RFC6268" class="cite xref">RFC6268</a>]</span>.  The new ASN.1 module <a href="#app-asn1-module" class="auto internal xref">Appendix B.2</a>
produces the same bits-on-the-wire as the one in RFC 5990.<a href="#section-1.6-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="use-of-the-rsa-kem-algorithm-in-cms">
<section id="section-2">
      <h2 id="name-use-of-the-rsa-kem-algorith">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-use-of-the-rsa-kem-algorith" class="section-name selfRef">Use of the RSA-KEM Algorithm in CMS</a>
      </h2>
<p id="section-2-1">The RSA-KEM Algorithm <span class="bcp14">MAY</span> be employed for one or more recipients in the
CMS enveloped-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, the CMS authenticated-data
content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, or the CMS authenticated-enveloped-data
content type <span>[<a href="#RFC5083" class="cite xref">RFC5083</a>]</span>.  In each case, the KEMRecipientInfo
<span>[<a href="#I-D.ietf-lamps-cms-kemri" class="cite xref">I-D.ietf-lamps-cms-kemri</a>]</span> is used with with the RSA-KEM Algorithm
to securely transfer the content-encryption key from the originator to
the recipient.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="underlying-components">
<section id="section-2.1">
        <h3 id="name-underlying-components">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-underlying-components" class="section-name selfRef">Underlying Components</a>
        </h3>
<p id="section-2.1-1">A CMS implementation that supports the RSA-KEM Algorithm <span class="bcp14">MUST</span> support at
least the following underlying components:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">For the key-derivation function, an implementation <span class="bcp14">MUST</span> support
KDF3 <span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span> with SHA-256 <span>[<a href="#SHS" class="cite xref">SHS</a>]</span>.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">For key-wrapping, an implementation <span class="bcp14">MUST</span> support the
AES-Wrap-128 <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span> key-encryption algorithm.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">An implementation <span class="bcp14">MAY</span> also support other key-derivation functions and
other key-encryption algorithms as well.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recipientinfo-conventions">
<section id="section-2.2">
        <h3 id="name-recipientinfo-conventions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-recipientinfo-conventions" class="section-name selfRef">RecipientInfo Conventions</a>
        </h3>
<p id="section-2.2-1">When the RSA-KEM Algorithm is employed for a recipient, the
RecipientInfo alternative for that recipient <span class="bcp14">MUST</span> be
OtherRecipientInfo using the KEMRecipientInfo structure
<span>[<a href="#I-D.ietf-lamps-cms-kemri" class="cite xref">I-D.ietf-lamps-cms-kemri</a>]</span>.  The fields of the
KEMRecipientInfo <span class="bcp14">MUST</span> have the following values:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1">version is the syntax version number; it <span class="bcp14">MUST</span> be 0.<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-3.1">
            <p id="section-2.2-3.1.1">rid identifies the recipient's certificate or public key.<a href="#section-2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-4.1">
            <p id="section-2.2-4.1.1">kem identifies the KEM algorithm; it <span class="bcp14">MUST</span> contain id-kem-rsa.<a href="#section-2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-5.1">
            <p id="section-2.2-5.1.1">kemct is the ciphertext produced for this recipient; it contains
C from steps 1 and 2 of Originator's Operations in <a href="#app-alg" class="auto internal xref">Appendix A</a>.<a href="#section-2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-6.1">
            <p id="section-2.2-6.1.1">kdf identifies the key-derivation function (KDF).  Note that the
KDF used for CMS RecipientInfo process <span class="bcp14">MAY</span> be different than the KDF
used within the RSA-KEM Algorithm.<a href="#section-2.2-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-7.1">
            <p id="section-2.2-7.1.1">kekLength is the size of the key-encryption key in octets.<a href="#section-2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-8.1">
            <p id="section-2.2-8.1.1">ukm is an optional random input to the key-derivation function.<a href="#section-2.2-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-9.1">
            <p id="section-2.2-9.1.1">wrap identifies a key-encryption algorithm used to encrypt the
keying material.<a href="#section-2.2-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-10.1">
            <p id="section-2.2-10.1.1">encryptedKey is the result of encrypting the keying material with the
key-encryption key.  When used with the CMS enveloped-data content
type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, the keying material is a content-encryption key.  When
used with the CMS authenticated-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, the
keying material is a message-authentication key.  When used with the
CMS authenticated-enveloped-data content type <span>[<a href="#RFC5083" class="cite xref">RFC5083</a>]</span>, the
keying material is a content-authenticated-encryption key.<a href="#section-2.2-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-11">NOTE: For backward compatibility, implementations <span class="bcp14">MAY</span> also support
RSA-KEM Key Transport Algorithm, identified by id-rsa-kem-spki, which uses
KeyTransRecipientInfo as specified in <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span>.<a href="#section-2.2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-conventions">
<section id="section-2.3">
        <h3 id="name-certificate-conventions">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-certificate-conventions" class="section-name selfRef">Certificate Conventions</a>
        </h3>
<p id="section-2.3-1">The conventions specified in this section augment RFC 5280 <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">A recipient who employs the RSA-KEM Algorithm <span class="bcp14">MAY</span> identify the public key
in a certificate by the same AlgorithmIdentifier as for the
PKCS #1 v1.5 algorithm, that is, using the rsaEncryption object
identifier <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.  The fact that the recipient will accept RSA-KEM
with this public key is not indicated by the use of this object
identifier.  The willingness to accept the RSA-KEM Algorithm <span class="bcp14">MAY</span> be
signaled by the use of the SMIMECapabilities Attribute as specified in
<span><a href="https://rfc-editor.org/rfc/rfc8551#section-2.5.2." class="relref">Section 2.5.2.</a> of [<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> or the SMIMECapabilities certificate
extension as specified in <span>[<a href="#RFC4262" class="cite xref">RFC4262</a>]</span>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">If the recipient wishes only to employ the RSA-KEM Algorithm with a given
public key, the recipient <span class="bcp14">MUST</span> identify the public key in the certificate
using the id-rsa-kem-spki object identifier; see <a href="#app-asn1" class="auto internal xref">Appendix B</a>.  The use
of the id-rsa-kem-spki object identifier allows certificates that were
issued to be compatible with RSA-KEM Key Transport to also be used with
this specification.  When the id-rsa-kem-spki object identifier appears
in the SubjectPublicKeyInfo algorithm field of the certificate, the
parameters field from AlgorithmIdentifier <span class="bcp14">SHOULD</span> be absent.  That is, the
AlgorithmIdentifier <span class="bcp14">SHOULD</span> be a SEQUENCE of one component, the
id-rsa-kem-spki object identifier.  With absent parameters, the KDF3
key-derivation function <span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span> with SHA-256 <span>[<a href="#SHS" class="cite xref">SHS</a>]</span> are used to
derive the shared secret.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">When the AlgorithmIdentifier parameters are present, the
GenericHybridParameters <span class="bcp14">MUST</span> be used.  Within the kem element, the algorithm
identifier <span class="bcp14">MUST</span> be set to id-kem-rsa, and RsaKemParameters <span class="bcp14">MUST</span> be included.
As described in <a href="#smimecap" class="auto internal xref">Section 2.4</a>, the GenericHybridParameters constrain the values
that can be used with the RSA public key for the kdf, kekLength, and wrap
fields of the KEMRecipientInfo structure.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">Regardless of the AlgorithmIdentifier used, the RSA public key <span class="bcp14">MUST</span> be
carried in the subjectPublicKey BIT STRING within the SubjectPublicKeyInfo
field of the certificate using the RSAPublicKey type defined in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">The intended application for the public key <span class="bcp14">MAY</span> be indicated in the key usage
certificate extension as specified in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.3" class="relref">Section 4.2.1.3</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.  If the
keyUsage extension is present in a certificate that conveys an RSA public key
with the id-rsa-kem-spki object identifier as discussed above, then the key
usage extension <span class="bcp14">MUST</span> contain only the following value:<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.3-7.1">
            <p id="section-2.3-7.1.1">keyEncipherment<a href="#section-2.3-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.3-8">The digitalSignatrure and dataEncipherment values <span class="bcp14">SHOULD NOT</span> be
present.  That is, a public key intended to be employed only with the
RSA-KEM Algorithm <span class="bcp14">SHOULD NOT</span> also be employed for data encryption or
for digital signatures.  Good cryptographic practice employs a given RSA
key pair in only one scheme.  This practice avoids the risk that vulnerability
in one scheme may compromise the security of the other, and may be essential
to maintain provable security.<a href="#section-2.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="smimecap">
<section id="section-2.4">
        <h3 id="name-smimecapabilities-attribute">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-smimecapabilities-attribute" class="section-name selfRef">SMIMECapabilities Attribute Conventions</a>
        </h3>
<p id="section-2.4-1"><span><a href="https://rfc-editor.org/rfc/rfc8551#section-2.5.2" class="relref">Section 2.5.2</a> of [<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> defines the SMIMECapabilities attribute to
announce a partial list of algorithms that an S/MIME implementation can
support.  When constructing a CMS signed-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>,
a compliant implementation <span class="bcp14">MAY</span> include the SMIMECapabilities attribute
that announces support for the RSA-KEM Algorithm.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">The SMIMECapability SEQUENCE representing the RSA-KEM Algorithm <span class="bcp14">MUST</span>
include the id-rsa-kem-spki object identifier in the capabilityID field;
see <a href="#app-asn1" class="auto internal xref">Appendix B</a> for the object identifier value, and see <a href="#app-example" class="auto internal xref">Appendix C</a>
for examples.  When the id-rsa-kem-spki object identifier appears in the
capabilityID field and the parameters are present, then the parameters
field <span class="bcp14">MUST</span> use the GenericHybridParameters type.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-3">
<pre>
  GenericHybridParameters ::= SEQUENCE {
    kem  KeyEncapsulationMechanism,
    dem  DataEncapsulationMechanism }
</pre><a href="#section-2.4-3" class="pilcrow">¶</a>
</div>
<p id="section-2.4-4">The fields of the GenericHybridParameters type have the following meanings:<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.4-5.1">
            <p id="section-2.4-5.1.1">kem is an AlgorithmIdentifer.  The algorithm field <span class="bcp14">MUST</span> be set to id-kem-rsa,
and the parameters field <span class="bcp14">MUST</span> be RsaKemParameters, which is a SEQUENCE of an
AlgorithmIdentifier that identifies the supported key-derivation function
and a positive INTEGER that identifies the length of the key-encryption
key in octets.<a href="#section-2.4-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.4-6.1">
            <p id="section-2.4-6.1.1">dem is an AlgorithmIdentifier.  The algorithm field <span class="bcp14">MUST</span> be present, and it
identifies the key-encryption algorithm.  The parameters are optional.  If the
GenericHybridParameters are present, then the provided dem value <span class="bcp14">MUST</span> be
used in the wrap field of KEMRecipientInfo.<a href="#section-2.4-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.4-7">If the GenericHybridParameters are present, then the provided kem value <span class="bcp14">MUST</span>
be used as the key-derivation function in the kdf field of KEMRecipientInfo,
and the provided key length <span class="bcp14">MUST</span> be used in the kekLength of KEMRecipientInfo.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">The RSA-KEM Algorithm should be considered as a replacement for the
widely implemented PKCS #1 v1.5 <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> for new applications
that use CMS to avoid potential vulnerabilities to chosen-ciphertext
attacks and gain a tighter security proof; however, the RSA-KEM Algorithm
has the disadvantage of slightly longer encrypted keying material.  With
PKCS #1 v1.5, the originator encrypts the key-encryption key directly with
the recipient's RSA public key.  With the RSA-KEM, the key-encryption key
is encrypted separately.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The security of the RSA-KEM Algorithm can be shown to be tightly related
to the difficulty of either solving the RSA problem, or breaking the
underlying symmetric key-encryption algorithm, if the underlying
key-derivation function is modeled as a random oracle, and assuming that
the symmetric key-encryption algorithm satisfies the properties of a
data encapsulation mechanism <span>[<a href="#SHOUP" class="cite xref">SHOUP</a>]</span>.  While in practice a random-oracle
result does not provide an actual security proof for any particular
key-derivation function, the result does provide assurance that the general
construction is reasonable; a key-derivation function would need to be
particularly weak to lead to an attack that is not possible in the
random-oracle model.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The RSA key size and the underlying components need to be selected
consistent with the desired security level.  Several security levels
have been identified in the NIST SP 800-57 Part 1 <span>[<a href="#NISTSP800-57pt1r5" class="cite xref">NISTSP800-57pt1r5</a>]</span>.
To achieve 128-bit security, the RSA key size <span class="bcp14">SHOULD</span> be at least 3072 bits,
the key-derivation function <span class="bcp14">SHOULD</span> make use of SHA-256, and the symmetric
key-encryption algorithm <span class="bcp14">SHOULD</span> be AES Key Wrap with a 128-bit key.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Implementations <span class="bcp14">MUST</span> protect the RSA private key, the key-encryption key,
the content-encryption key, message-authentication key, and the
content-authenticated-encryption key.  Disclosure of the RSA private key
could result in the compromise of all messages protected with that key.
Disclosure of the key-encryption key, the content-encryption key, or the
content-authenticated-encryption key could result in compromise of the
associated encrypted content.  Disclosure of the key-encryption key, the
message-authentication key, or the content-authenticated-encryption key
could allow modification of the associated authenticated content.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Additional considerations related to key management may be found in
<span>[<a href="#NISTSP800-57pt1r5" class="cite xref">NISTSP800-57pt1r5</a>]</span>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The security of the RSA-KEM Algorithm depends on a quality random number
generator.  For further discussion on random number generation,
see <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span>.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">The RSA-KEM Algorithm does not use an explicit padding scheme; instead,
an encoded random value (z) between zero and the RSA modulus minus one (n-1)
is directly encrypted with the recipient's RSA public key.  The
IntegerToString(z, nLen) encoding produces a string that is the full length of
the RSA modulus.  In addition, the random value is passed through a key-derivation
function (KDF) to reduce possible harm from a poorly implemented random number
source or a maliciously chosen random value (z).  Implementations <span class="bcp14">SHOULD NOT</span>
use z directly for any purpose.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">As long as a fresh random integer z is chosen as part of each invocation
of the Encapsulate() function, RSA-KEM does not degrade as the number of
ciphertexts increases.  Since RSA encryption provides a bijective map,
a collision in the KDF is the only way that RSA-KEM can produce more than
one ciphertext that encapsulates the same shared secret.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">The RSA-KEM Algorithm provides a fixed-length ciphertext.  The recipient <span class="bcp14">MUST</span>
check that the received byte string is the expected length and the length
corresponds to an integer in the expected range prior to attempting decryption
with their RSA private key as described in Steps 1 and 2 of <a href="#app-alg-decap" class="auto internal xref">Appendix A.2</a>.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">Implementations <span class="bcp14">SHOULD NOT</span> reveal information about intermediate
values or calculations, whether by timing or other "side channels",
otherwise an opponent may be able to determine information about
the keying data and/or the recipient's private key.  Although not all
intermediate information may be useful to an opponent, it is
preferable to conceal as much information as is practical, unless
analysis specifically indicates that the information would not be
useful to an opponent.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">Generally, good cryptographic practice employs a given RSA key pair
in only one scheme.  This practice avoids the risk that vulnerability
in one scheme may compromise the security of the other, and may be
essential to maintain provable security.  While RSA public keys have
often been employed for multiple purposes such as key transport and
digital signature without any known bad interactions, for increased
security assurance, such combined use of an RSA key pair is <span class="bcp14">NOT RECOMMENDED</span> in the future (unless the different schemes are
specifically designed to be used together).<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">Accordingly, an RSA key pair used for the RSA-KEM Algorithm <span class="bcp14">SHOULD NOT</span>
also be used for digital signatures.  Indeed, the Accredited Standards
Committee X9 (ASC X9) requires such a separation between key pairs used
for key establishment and key pairs used for digital signature
<span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span>.  Continuing this principle of key separation, a key pair
used for the RSA-KEM Algorithm <span class="bcp14">SHOULD NOT</span> be used with other key
establishment schemes, or for data encryption, or with more
than one set of underlying algorithm components.<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13">It is acceptable to use the same RSA key pair for RSA-KEM Key Transport
as specified in <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span> and this specification.  This is acceptable
because the operations involving the RSA public key and the RSA private
key are identical in the two specifications.<a href="#section-3-13" class="pilcrow">¶</a></p>
<p id="section-3-14">Parties <span class="bcp14">MAY</span> gain assurance that implementations are correct through
formal implementation validation, such as the NIST Cryptographic
Module Validation Program (CMVP) <span>[<a href="#CMVP" class="cite xref">CMVP</a>]</span>.<a href="#section-3-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">For the ASN.1 Module in <a href="#app-asn1-module" class="auto internal xref">Appendix B.2</a>, IANA is requested to assign an
object identifier (OID) for the module identifier. The OID for the module
should be allocated in the "SMI Security for S/MIME Module Identifier"
registry (1.2.840.113549.1.9.16.0), and the Description for the new OID
should be set to "id-mod-cms-rsa-kem-2023".<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ANS-X9.44">[ANS-X9.44]</dt>
        <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Public Key Cryptography for the Financial Services Industry -- Key Establishment Using Integer Factorization Cryptography"</span>, <span class="seriesInfo">American National Standard X9.44</span>, <time datetime="2007" class="refDate">2007</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cms-kemri">[I-D.ietf-lamps-cms-kemri]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Gray, J.</span>, and <span class="refAuthor">T. Okubo</span>, <span class="refTitle">"Using Key Encapsulation Mechanism (KEM) Algorithms in the Cryptographic Message Syntax (CMS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cms-kemri-08</span>, <time datetime="2024-02-06" class="refDate">6 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-kemri-08">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-kemri-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO18033-2">[ISO18033-2]</dt>
        <dd>
<span class="refAuthor">ISO/IEC JTC 1/SC 27</span>, <span class="refTitle">"Information technology -- Security techniques -- Encryption algorithms -- Part 2: Asymmetric ciphers"</span>, <span class="seriesInfo">ISO/IEC 18033-2:2006</span>, <time datetime="2006" class="refDate">2006</time>, <span>&lt;<a href="https://www.iso.org/standard/37971.html">https://www.iso.org/standard/37971.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5083">[RFC5083]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type"</span>, <span class="seriesInfo">RFC 5083</span>, <span class="seriesInfo">DOI 10.17487/RFC5083</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5083">https://www.rfc-editor.org/info/rfc5083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5911">[RFC5911]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for Cryptographic Message Syntax (CMS) and S/MIME"</span>, <span class="seriesInfo">RFC 5911</span>, <span class="seriesInfo">DOI 10.17487/RFC5911</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5911">https://www.rfc-editor.org/info/rfc5911</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6268">[RFC6268]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 6268</span>, <span class="seriesInfo">DOI 10.17487/RFC6268</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6268">https://www.rfc-editor.org/info/rfc6268</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.180-4</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.180-4">https://doi.org/10.6028/nist.fips.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology -- Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="seriesInfo">ITU-T Recommendation X.680</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology -- ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CMVP">[CMVP]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Cryptographic Module Validation Program"</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://csrc.nist.gov/projects/cryptographic-module-validation-program">https://csrc.nist.gov/projects/cryptographic-module-validation-program</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NISTSP800-57pt1r5">[NISTSP800-57pt1r5]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Key Management:Part 1 - General"</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-57pt1r5</span>, <time datetime="2020-05" class="refDate">May 2020</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-57pt1r5">https://doi.org/10.6028/nist.sp.800-57pt1r5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4262">[RFC4262]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refTitle">"X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities"</span>, <span class="seriesInfo">RFC 4262</span>, <span class="seriesInfo">DOI 10.17487/RFC4262</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4262">https://www.rfc-editor.org/info/rfc4262</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5990">[RFC5990]</dt>
        <dd>
<span class="refAuthor">Randall, J.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Brainard, J.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Use of the RSA-KEM Key Transport Algorithm in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 5990</span>, <span class="seriesInfo">DOI 10.17487/RFC5990</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5990">https://www.rfc-editor.org/info/rfc5990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6194">[RFC6194]</dt>
        <dd>
<span class="refAuthor">Polk, T.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms"</span>, <span class="seriesInfo">RFC 6194</span>, <span class="seriesInfo">DOI 10.17487/RFC6194</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6194">https://www.rfc-editor.org/info/rfc6194</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHOUP">[SHOUP]</dt>
      <dd>
<span class="refAuthor">Shoup, V.</span>, <span class="refTitle">"A Proposal for an ISO Standard for Public Key Encryption"</span>, <span class="seriesInfo">Cryptology ePrint Archive Paper 2001/112</span>, <time datetime="2001" class="refDate">2001</time>, <span>&lt;<a href="https://eprint.iacr.org/2001/112">https://eprint.iacr.org/2001/112</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="app-alg">
<section id="appendix-A">
      <h2 id="name-rsa-kem-algorithm">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-rsa-kem-algorithm" class="section-name selfRef">RSA-KEM Algorithm</a>
      </h2>
<p id="appendix-A-1">The RSA-KEM Algorithm is a one-pass (store-and-forward) cryptographic
mechanism for an originator to securely send keying material to a recipient
using the recipient's RSA public key.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">With the RSA-KEM Algorithm, an originator encrypts a random integer (z) with
the recipient's RSA public key to produce a ciphertext (C), and the originator
derives a shared secret (SS) from the random integer (z).  The originator then
sends the ciphertext (C) to the recipient.  The recipient decrypts the
ciphertext (C) using the their private key to recover the random integer (z),
and the recipient derives a shared secret (SS) from the random integer(z).  In
this way, originator and recipient obtain the same shared secret (SS).<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">The RSA-KEM Algorithm depends on a key-derivation function (KDF), which is
used to derive the shared secret (SS).  Many key-derivation functions support
the inclusion of other information in addition to the shared secret (SS) in
the input to the function; however, no other information is included as an
input to the KDF by the RSA-KEM Algorithm.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div id="app-alg-encap">
<section id="appendix-A.1">
        <h3 id="name-originators-operations-rsa-">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-originators-operations-rsa-" class="section-name selfRef">Originator's Operations: RSA-KEM Encapsulate()</a>
        </h3>
<p id="appendix-A.1-1">Let (n,e) be the recipient's RSA public key; see <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> for details.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Let nLen denote the length in bytes of the modulus n, i.e., the least
integer such that 2^(8*nLen) &gt; n.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">The originator performs the following operations:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.1-4">
<li id="appendix-A.1-4.1">
            <p id="appendix-A.1-4.1.1">Generate a random integer z between 0 and n-1 (see note), and
convert z to a byte string Z of length nLen, most significant byte
first:<a href="#appendix-A.1-4.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4.1.2">
<pre>
     z = RandomInteger (0, n-1)

     Z = IntegerToString (z, nLen)
</pre><a href="#appendix-A.1-4.1.2" class="pilcrow">¶</a>
</div>
</li>
          <li id="appendix-A.1-4.2">
            <p id="appendix-A.1-4.2.1">Encrypt the random integer Z using the recipient's RSA public key
(n,e), and convert the resulting integer c to a ciphertext C, a
byte string of length nLen:<a href="#appendix-A.1-4.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4.2.2">
<pre>
     c = z^e mod n

     C = IntegerToString (c, nLen)
</pre><a href="#appendix-A.1-4.2.2" class="pilcrow">¶</a>
</div>
</li>
          <li id="appendix-A.1-4.3">
            <p id="appendix-A.1-4.3.1">Derive a symmetric shared secret SS of length ssLen bytes from the
byte string Z using the underlying key-derivation function:<a href="#appendix-A.1-4.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4.3.2">
<pre>
     SS = KDF (Z, ssLen)
</pre><a href="#appendix-A.1-4.3.2" class="pilcrow">¶</a>
</div>
</li>
          <li id="appendix-A.1-4.4">
            <p id="appendix-A.1-4.4.1">Output the shared secret SS and the ciphertext C.  Send the
ciphertext C to the recipient.<a href="#appendix-A.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="appendix-A.1-5">NOTE: The random integer z <span class="bcp14">MUST</span> be generated independently at random
for different encryption operations, whether for the same or different
recipients.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app-alg-decap">
<section id="appendix-A.2">
        <h3 id="name-recipients-operations-rsa-k">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-recipients-operations-rsa-k" class="section-name selfRef">Recipient's Operations: RSA-KEM Decapsulate()</a>
        </h3>
<p id="appendix-A.2-1">Let (n,d) be the recipient's RSA private key; see <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> for details,
but other private key formats are allowed.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">Let C be the ciphertext received from the originator.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">Let nLen denote the length in bytes of the modulus n.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">The recipient performs the following operations:<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2-5">
<li id="appendix-A.2-5.1">
            <p id="appendix-A.2-5.1.1">If the length of the encrypted keying material is less than nLen
bytes, output "decryption error", and stop.<a href="#appendix-A.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-5.2">
            <p id="appendix-A.2-5.2.1">Convert the ciphertext C to an integer c, most significant byte
first (see NOTE below):<a href="#appendix-A.2-5.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5.2.2">
<pre>
     c = StringToInteger (C)
</pre><a href="#appendix-A.2-5.2.2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-5.2.3">
If the integer c is not between 0 and n-1, output "decryption
error", and stop.<a href="#appendix-A.2-5.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-5.3">
            <p id="appendix-A.2-5.3.1">Decrypt the integer c using the recipient's private key
(n,d) to recover an integer z (see NOTE below):<a href="#appendix-A.2-5.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5.3.2">
<pre>
     z = c^d mod n
</pre><a href="#appendix-A.2-5.3.2" class="pilcrow">¶</a>
</div>
</li>
          <li id="appendix-A.2-5.4">
            <p id="appendix-A.2-5.4.1">Convert the integer z to a byte string Z of length nLen, most
significant byte first (see NOTE below):<a href="#appendix-A.2-5.4.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5.4.2">
<pre>
     Z = IntegerToString (z, nLen)
</pre><a href="#appendix-A.2-5.4.2" class="pilcrow">¶</a>
</div>
</li>
          <li id="appendix-A.2-5.5">
            <p id="appendix-A.2-5.5.1">Derive a shared secret SS of length ssLen bytes from the byte
string Z using the key-derivation function (see NOTE below):<a href="#appendix-A.2-5.5.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-5.5.2">
<pre>
     SS = KDF (Z, ssLen)
</pre><a href="#appendix-A.2-5.5.2" class="pilcrow">¶</a>
</div>
</li>
          <li id="appendix-A.2-5.6">
            <p id="appendix-A.2-5.6.1">Output the shared secret SS.<a href="#appendix-A.2-5.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="appendix-A.2-6">NOTE: Implementations <span class="bcp14">SHOULD NOT</span> reveal information about the
integer z, the string Z, or about the calculation of the
exponentiation in Step 2, the conversion in Step 3, or the key
derivation in Step 4, whether by timing or other "side channels".
The observable behavior of the implementation <span class="bcp14">SHOULD</span> be the same at
these steps for all ciphertexts C that are in range.  For example,
IntegerToString conversion should take the same amount of time
regardless of the actual value of the integer z.  The integer z, the
string Z, and other intermediate results <span class="bcp14">MUST</span> be securely deleted
when they are no longer needed.<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="app-asn1">
<section id="appendix-B">
      <h2 id="name-asn1-syntax">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-asn1-syntax" class="section-name selfRef">ASN.1 Syntax</a>
      </h2>
<p id="appendix-B-1">The ASN.1 syntax for identifying the RSA-KEM Algorithm
is an extension of the syntax for the "generic hybrid cipher" in
ANS X9.44 <span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The ASN.1 Module is unchanged from RFC 5990.  The id-rsa-kem-spki
object identifier is used in a backward compatible manner
in certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and SMIMECapabilities <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>.
Of course, the use of the id-kem-rsa object identifier in the
new KEMRecipientInfo structure <span>[<a href="#I-D.ietf-lamps-cms-kemri" class="cite xref">I-D.ietf-lamps-cms-kemri</a>]</span>
was not yet defined at the time that RFC 5990 was written.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<div id="app-asn1-intro">
<section id="appendix-B.1">
        <h3 id="name-underlying-components-2">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-underlying-components-2" class="section-name selfRef">Underlying Components</a>
        </h3>
<p id="appendix-B.1-1">Implementations that conform to this specification <span class="bcp14">MUST</span> support
the KDF3 <span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span> key-derivation function using SHA-256 <span>[<a href="#SHS" class="cite xref">SHS</a>]</span>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">KDF2 <span>[<a href="#ANS-X9.44" class="cite xref">ANS-X9.44</a>]</span> and KDF3 are both key-derivation functions based on
a hash function.  The only difference between KDF2 and KDF3 is the order
of the components to be hashed.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-3">
<pre>
   KDF2 calculates T as:   T = T || Hash (Z || D || otherInfo)

   KDF3 calculates T as:   T = T || Hash (D || Z || otherInfo)
</pre><a href="#appendix-B.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-4">The object identifier for KDF3 is:<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-5">
<pre>
   id-kdf-kdf3 OBJECT IDENTIFIER ::= { x9-44-components kdf3(2) }
</pre><a href="#appendix-B.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-6">The KDF3 parameters identify the underlying hash function.  For
alignment with the ANS X9.44, the hash function <span class="bcp14">MUST</span> be an ASC X9-approved
hash function.  While the SHA-1 hash algorithm is included in the
ASN.1 definitions, SHA-1 <span class="bcp14">MUST NOT</span> be used.  SHA-1 is considered
to be obsolete; see <span>[<a href="#RFC6194" class="cite xref">RFC6194</a>]</span>.  SHA-1 remains in the ASN.1 module for
compatibility with RFC 5990.  In addition, other hash functions <span class="bcp14">MAY</span> be
used with CMS.<a href="#appendix-B.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-7">
<pre>
   kda-kdf3 KEY-DERIVATION ::= {
      IDENTIFIER id-kdf-kdf3
      PARAMS TYPE KDF3-HashFunction ARE required
      -- No S/MIME caps defined -- }

   KDF3-HashFunction ::=
      AlgorithmIdentifier { DIGEST-ALGORITHM, {KDF3-HashFunctions} }

   KDF3-HashFunctions DIGEST-ALGORITHM ::= { X9-HashFunctions, ... }

   X9-HashFunctions DIGEST-ALGORITHM ::= {
      mda-sha1 | mda-sha224 | mda-sha256 | mda-sha384 |
      mda-sha512, ... }
</pre><a href="#appendix-B.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-8">Implementations that conform to this specification <span class="bcp14">MUST</span> support
the AES Key Wrap <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span> key-encryption algorithm with a 128-bit
key.  There are three object identifiers for the AES Key Wrap, one for
each permitted size of the key-encryption key.  There are three object
identifiers imported from <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span>, and none of these algorithm
identifiers have associated parameters:<a href="#appendix-B.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-9">
<pre>
   kwa-aes128-wrap KEY-WRAP ::= {
       IDENTIFIER id-aes128-wrap
       PARAMS ARE absent
       SMIME-CAPS { IDENTIFIED BY id-aes128-wrap } }

   kwa-aes192-wrap KEY-WRAP ::= {
       IDENTIFIER id-aes192-wrap
       PARAMS ARE absent
       SMIME-CAPS { IDENTIFIED BY id-aes192-wrap } }

   kwa-aes256-wrap KEY-WRAP ::= {
       IDENTIFIER id-aes256-wrap
       PARAMS ARE absent
       SMIME-CAPS { IDENTIFIED BY id-aes256-wrap } }
</pre><a href="#appendix-B.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="app-asn1-module">
<section id="appendix-B.2">
        <h3 id="name-asn1-module">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
        </h3>
<p id="appendix-B.2-1">RFC EDITOR: Please replace TBD2 with the value assigned by IANA
during the publication of <span>[<a href="#I-D.ietf-lamps-cms-kemri" class="cite xref">I-D.ietf-lamps-cms-kemri</a>]</span>.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div class="breakable lang-asn.1 sourcecode" id="appendix-B.2-2">
<pre>&lt;CODE BEGINS&gt;
CMS-RSA-KEM-2023
   { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
     pkcs-9(9) smime(16) modules(0) id-mod-cms-rsa-kem-2023(TBD1) }

   DEFINITIONS EXPLICIT TAGS ::= BEGIN

-- EXPORTS ALL

IMPORTS

  KEM-ALGORITHM
    FROM KEMAlgorithmInformation-2023  -- [I-D.ietf-lamps-cms-kemri]
       { iso(1) identified-organization(3) dod(6) internet(1)
         security(5) mechanisms(5) pkix(7) id-mod(0)
         id-mod-kemAlgorithmInformation-2023(TBD3) }

  AlgorithmIdentifier{}, PUBLIC-KEY, DIGEST-ALGORITHM,
  KEY-DERIVATION, KEY-WRAP, SMIME-CAPS
    FROM AlgorithmInformation-2009  -- [RFC5912]
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-algorithmInformation-02(58) }

  kwa-aes128-wrap, kwa-aes192-wrap, kwa-aes256-wrap
    FROM CMSAesRsaesOaep-2009  -- [RFC5911]
      { iso(1) member-body(2) us(840) rsadsi(113549)
        pkcs(1) pkcs-9(9) smime(16) modules(0)
        id-mod-cms-aes-02(38) }

  kwa-3DESWrap
    FROM CryptographicMessageSyntaxAlgorithms-2009  -- [RFC5911]
      { iso(1) member-body(2) us(840) rsadsi(113549)
        pkcs(1) pkcs-9(9) smime(16) modules(0)
        id-mod-cmsalg-2001-02(37) }

  id-camellia128-wrap, id-camellia192-wrap, id-camellia256-wrap
    FROM CamelliaEncryptionAlgorithmInCMS  -- [RFC3657]
      { iso(1) member-body(2) us(840) rsadsi(113549)
        pkcs(1) pkcs9(9) smime(16) modules(0)
        id-mod-cms-camellia(23) }

  mda-sha1, pk-rsa, RSAPublicKey
    FROM PKIXAlgs-2009  -- [RFC5912]
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix1-algorithms2008-02(56) }

  mda-sha224, mda-sha256, mda-sha384, mda-sha512
    FROM PKIX1-PSS-OAEP-Algorithms-2009  -- [RFC5912]
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix1-rsa-pkalgs-02(54) } ;


-- Useful types and definitions

OID ::= OBJECT IDENTIFIER  -- alias

NullParms ::= NULL

-- ISO/IEC 18033-2 arc

is18033-2 OID ::= { iso(1) standard(0) is18033(18033) part2(2) }

-- NIST algorithm arc

nistAlgorithm OID ::= { joint-iso-itu-t(2) country(16) us(840)
   organization(1) gov(101) csor(3) nistAlgorithm(4) }

-- PKCS #1 arc

pkcs-1 OID ::= { iso(1) member-body(2) us(840) rsadsi(113549)
   pkcs(1) pkcs-1(1) }

-- X9.44 arc

x9-44 OID ::= { iso(1) identified-organization(3) tc68(133)
   country(16) x9(840) x9Standards(9) x9-44(44) }

x9-44-components OID ::= { x9-44 components(1) }

-- RSA-KEM Algorithm

id-rsa-kem OID ::= { iso(1) member-body(2) us(840) rsadsi(113549)
   pkcs(1) pkcs-9(9) smime(16) alg(3) 14 }

id-rsa-kem-spki OID ::= id-rsa-kem

GenericHybridParameters ::= SEQUENCE {
   kem  KeyEncapsulationMechanism,
   dem  DataEncapsulationMechanism }

KeyEncapsulationMechanism ::=
   AlgorithmIdentifier { KEM-ALGORITHM, {KEMAlgorithms} }

KEMAlgorithms KEM-ALGORITHM ::= { kema-kem-rsa | kema-rsa-kem, ... }

kema-rsa-kem KEM-ALGORITHM ::= {
   IDENTIFIER id-rsa-kem-spki
   PARAMS TYPE GenericHybridParameters ARE optional
   PUBLIC-KEYS { pk-rsa | pk-rsa-kem }
   UKM ARE optional
   SMIME-CAPS { TYPE GenericHybridParameters
      IDENTIFIED BY id-rsa-kem-spki } }

kema-kem-rsa KEM-ALGORITHM ::= {
   IDENTIFIER id-kem-rsa
   PARAMS TYPE RsaKemParameters ARE optional
   PUBLIC-KEYS { pk-rsa | pk-rsa-kem }
   UKM ARE optional
   SMIME-CAPS { TYPE GenericHybridParameters
      IDENTIFIED BY id-rsa-kem-spki } }

id-kem-rsa OID ::= { is18033-2 key-encapsulation-mechanism(2)
   rsa(4) }

RsaKemParameters ::= SEQUENCE {
   keyDerivationFunction  KeyDerivationFunction,
   keyLength              KeyLength }

pk-rsa-kem PUBLIC-KEY ::= {
  IDENTIFIER id-rsa-kem-spki
  KEY RSAPublicKey
  PARAMS TYPE GenericHybridParameters ARE preferredAbsent
  -- Private key format is not specified here --
  CERT-KEY-USAGE {keyEncipherment} }

KeyDerivationFunction ::=
   AlgorithmIdentifier { KEY-DERIVATION, {KDFAlgorithms} }

KDFAlgorithms KEY-DERIVATION ::= { kda-kdf2 | kda-kdf3, ... }

KeyLength ::= INTEGER (1..MAX)

DataEncapsulationMechanism ::=
   AlgorithmIdentifier { KEY-WRAP, {DEMAlgorithms} }

DEMAlgorithms KEY-WRAP ::= {
   X9-SymmetricKeyWrappingSchemes |
   Camellia-KeyWrappingSchemes, ... }

X9-SymmetricKeyWrappingSchemes KEY-WRAP ::= {
   kwa-aes128-wrap | kwa-aes192-wrap | kwa-aes256-wrap |
   kwa-3DESWrap, ... }

X9-SymmetricKeyWrappingScheme ::=
   AlgorithmIdentifier { KEY-WRAP, {X9-SymmetricKeyWrappingSchemes} }

Camellia-KeyWrappingSchemes KEY-WRAP ::= {
   kwa-camellia128-wrap | kwa-camellia192-wrap |
   kwa-camellia256-wrap, ... }

Camellia-KeyWrappingScheme ::=
   AlgorithmIdentifier { KEY-WRAP, {Camellia-KeyWrappingSchemes} }

kwa-camellia128-wrap KEY-WRAP ::= {
   IDENTIFIER id-camellia128-wrap
   PARAMS ARE absent
   SMIME-CAPS { IDENTIFIED BY id-camellia128-wrap } }

kwa-camellia192-wrap KEY-WRAP ::= {
   IDENTIFIER id-camellia192-wrap
   PARAMS ARE absent
   SMIME-CAPS { IDENTIFIED BY id-camellia192-wrap } }

kwa-camellia256-wrap KEY-WRAP ::= {
   IDENTIFIER id-camellia256-wrap
   PARAMS ARE absent
   SMIME-CAPS { IDENTIFIED BY id-camellia256-wrap } }

-- Key Derivation Functions

id-kdf-kdf2 OID ::= { x9-44-components kdf2(1) }

kda-kdf2 KEY-DERIVATION ::= {
   IDENTIFIER id-kdf-kdf2
   PARAMS TYPE KDF2-HashFunction ARE required
   -- No S/MIME caps defined -- }

KDF2-HashFunction ::=
   AlgorithmIdentifier { DIGEST-ALGORITHM, {KDF2-HashFunctions} }

KDF2-HashFunctions DIGEST-ALGORITHM ::= { X9-HashFunctions, ... }

id-kdf-kdf3 OID ::= { x9-44-components kdf3(2) }

kda-kdf3 KEY-DERIVATION ::= {
   IDENTIFIER id-kdf-kdf3
   PARAMS TYPE KDF3-HashFunction ARE required
   -- No S/MIME caps defined -- }

KDF3-HashFunction ::=
   AlgorithmIdentifier { DIGEST-ALGORITHM, {KDF3-HashFunctions} }

KDF3-HashFunctions DIGEST-ALGORITHM ::= { X9-HashFunctions, ... }

-- Hash Functions

X9-HashFunctions DIGEST-ALGORITHM ::= {
   mda-sha1 | mda-sha224 | mda-sha256 | mda-sha384 |
   mda-sha512, ... }

-- Updates for the SMIME-CAPS Set from RFC 5911

SMimeCapsSet SMIME-CAPS ::= {
   kema-kem-rsa.&amp;smimeCaps |
   kwa-aes128-wrap |
   kwa-aes192-wrap |
   kwa-aes256-wrap |
   kwa-camellia128-wrap.&amp;smimeCaps |
   kwa-camellia192-wrap.&amp;smimeCaps |
   kwa-camellia256-wrap.&amp;smimeCaps,
   ... }

END

&lt;CODE ENDS&gt;</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="app-example">
<section id="appendix-C">
      <h2 id="name-smimecapabilities-examples">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-smimecapabilities-examples" class="section-name selfRef">SMIMECapabilities Examples</a>
      </h2>
<p id="appendix-C-1">To indicate support for the RSA-KEM algorithm coupled with the KDF3
key-derivation function with SHA-256 and the AES Key Wrap symmetric
key-encryption algorithm 128-bit key-encryption key, the
SMIMECapabilities will include the following entry:<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C-2">
<pre>
SEQUENCE {
   id-rsa-kem-spki,                           -- RSA-KEM Algorithm
   SEQUENCE {                           -- GenericHybridParameters
      SEQUENCE {                    -- key encapsulation mechanism
         id-kem-rsa,                                    -- RSA-KEM
         SEQUENCE {                            -- RsaKemParameters
            SEQUENCE {                  -- key derivation function
               id-kdf-kdf3,                                -- KDF3
               SEQUENCE {                     -- KDF3-HashFunction
                  id-sha256  -- SHA-256; no parameters (preferred)
               },
            16                              -- KEK length in bytes
            },
      SEQUENCE {                   -- data encapsulation mechanism
         id-aes128-Wrap             -- AES-128 Wrap; no parameters
      }
   }
}
</pre><a href="#appendix-C-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C-3">This SMIMECapability value has the following DER encoding (in hexadecimal):<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C-4">
<pre>
30 47
  06 0b 2a 86 48 86 f7 0d 01 09 10 03 0e          -- id-rsa-kem-spki
  30 38
     30 29
        06 07 28 81 8c 71 02 02 04                -- id-kem-rsa
        30 1e
           30 19
              06 0a 2b 81 05 10 86 48 09 2c 01 02 -- id-kdf-kdf3
              30 0b
                 06 09 60 86 48 01 65 03 04 02 01 -- id-sha256
                 02 01 10                         -- 16 bytes
      30 0b
         06 09 60 86 48 01 65 03 04 01 05         -- id-aes128-Wrap
</pre><a href="#appendix-C-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C-5">To indicate support for the RSA-KEM algorithm coupled with the KDF3
key-derivation function with SHA-384 and the AES Key Wrap symmetric
key-encryption algorithm 192-bit key-encryption key, the
SMIMECapabilities will include the following SMIMECapability value
(in hexadecimal):<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C-6">
<pre>
  30 47 06 0b 2a 86 48 86 f7 0d 01 09 10 03 0e 30
  38 30 29 06 07 28 81 8c 71 02 02 04 30 1e 30 19
  06 0a 2b 81 05 10 86 48 09 2c 01 02 30 0b 06 09
  60 86 48 01 65 03 04 02 02 02 01 18 30 0b 06 09
  60 86 48 01 65 03 04 01 19
</pre><a href="#appendix-C-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C-7">To indicate support for the RSA-KEM algorithm coupled with the KDF3
key-derivation function with SHA-512 and the AES Key Wrap symmetric
key-encryption algorithm 256-bit key-encryption key, the
SMIMECapabilities will include the following SMIMECapability value
(in hexadecimal):<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C-8">
<pre>
  30 47 06 0b 2a 86 48 86 f7 0d 01 09 10 03 0e 30
  38 30 29 06 07 28 81 8c 71 02 02 04 30 1e 30 19
  06 0a 2b 81 05 10 86 48 09 2c 01 02 30 0b 06 09
  60 86 48 01 65 03 04 02 03 02 01 20 30 0b 06 09
  60 86 48 01 65 03 04 01 2d
</pre><a href="#appendix-C-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="rsa-kem-cms-enveloped-data-example">
<section id="appendix-D">
      <h2 id="name-rsa-kem-cms-enveloped-data-">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-rsa-kem-cms-enveloped-data-" class="section-name selfRef">RSA-KEM CMS Enveloped-Data Example</a>
      </h2>
<p id="appendix-D-1">This example shows the establishment of an AES-128 content-encryption
key using:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1">
          <p id="appendix-D-2.1.1">RSA-KEM with a 3072-bit key and KDF3 with SHA-256;<a href="#appendix-D-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-2.2">
          <p id="appendix-D-2.2.1">KEMRecipientInfo key derivation using KDF3 with SHA-256; and<a href="#appendix-D-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-2.3">
          <p id="appendix-D-2.3.1">KEMRecipientInfo key wrap using AES-128-KEYWRAP.<a href="#appendix-D-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-3">In real-world use, the originator would encrypt the content-encryption
key in a manner that would allow decryption with their own private key
as well as the recipient's private key.  This is omitted in an attempt
to simplify the example.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<div id="originator-rsa-kem-encapsulate-processing">
<section id="appendix-D.1">
        <h3 id="name-originator-rsa-kem-encapsul">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-originator-rsa-kem-encapsul" class="section-name selfRef">Originator RSA-KEM Encapsulate() Processing</a>
        </h3>
<p id="appendix-D.1-1">Alice obtains Bob's public key:<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1-2">
<pre>
   -----BEGIN PUBLIC KEY-----
   MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEA3ocW14cxncPJ47fnEjBZ
   AyfC2lqapL3ET4jvV6C7gGeVrRQxWPDwl+cFYBBR2ej3j3/0ecDmu+XuVi2+s5JH
   Keeza+itfuhsz3yifgeEpeK8T+SusHhn20/NBLhYKbh3kiAcCgQ56dpDrDvDcLqq
   vS3jg/VO+OPnZbofoHOOevt8Q/roahJe1PlIyQ4udWB8zZezJ4mLLfbOA9YVaYXx
   2AHHZJevo3nmRnlgJXo6mE00E/6qkhjDHKSMdl2WG6mO9TCDZc9qY3cAJDU6Ir0v
   SH7qUl8/vN13y4UOFkn8hM4kmZ6bJqbZt5NbjHtY4uQ0VMW3RyESzhrO02mrp39a
   uLNnH3EXdXaV1tk75H3qC7zJaeGWMJyQfOE3YfEGRKn8fxubji716D8UecAxAzFy
   FL6m1JiOyV5acAiOpxN14qRYZdHnXOM9DqGIGpoeY1UuD4Mo05osOqOUpBJHA9fS
   whSZG7VNf+vgNWTLNYSYLI04KiMdulnvU6ds+QPz+KKtAgMBAAE=
   -----END PUBLIC KEY-----
</pre><a href="#appendix-D.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D.1-3">Bob's RSA public key has the following key identifier:<a href="#appendix-D.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1-4">
<pre>
   9eeb67c9b95a74d44d2f16396680e801b5cba49c
</pre><a href="#appendix-D.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-D.1-5">Alice randomly generates integer z between 0 and n-1:<a href="#appendix-D.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1-6">
<pre>
   9c126102a5c1c0354672a3c2f19fc9ddea988f815e1da812c7bd4f8eb082bdd1
   4f85a7f7c2f1af11d5333e0d6bcb375bf855f208da72ba27e6fb0655f2825aa6
   2b93b1f9bbd3491fed58f0380fa0de36430e3a144d569600bd362609be5b9481
   0875990b614e406fa6dff500043cbca95968faba61f795096a7fb3687a51078c
   4ca2cb663366b0bea0cd9cccac72a25f3f4ed03deb68b4453bba44b943f4367b
   67d6cd10c8ace53f545aac50968fc3c6ecc80f3224b64e37038504e2d2c0e2b2
   9d45e46c62826d96331360e4c17ea3ef89a9efc5fac99eda830e81450b6534dc
   0bdf042b8f3b706649c631fe51fc2445cc8d447203ec2f41f79cdfea16de1ce6
   abdfdc1e2ef2e5d5d8a65e645f397240ef5a26f5e4ff715de782e30ecf477293
   e89e13171405909a8e04dd31d21d0c57935fc1ceea8e1033e31e1bc8c56da0f3
   d79510f3f380ff58e5a61d361f2f18e99fbae5663172e8cd1f21deaddc5bbbea
   060d55f1842b93d1a9c888d0bf85d0af9947fe51acf940c7e7577eb79cabecb3
</pre><a href="#appendix-D.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-D.1-7">Alice encrypts integer z using the Bob's RSA public key, the result is
called ct:<a href="#appendix-D.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1-8">
<pre>
   c071fc273af8e7bdb152e06bf73310361074154a43abcf3c93c13499d2065344
   3eed9ef5d3c0685e4aa76a6854815bb97691ff9f8dac15eea7d74f452bf350a6
   46163d68288e978cbf7a73089ee52712f9a4f49e06ace7bbc85ab14d4e336c97
   c5728a2654138c7b26e8835c6b0a9fbed26495c4eadf745a2933be283f6a88b1
   6695fc06666873cfb6d36718ef3376cefc100c3941f3c494944078325807a559
   186b95ccabf3714cfaf79f83bd30537fdd9aed5a4cdcbd8bd0486faed73e9d48
   6b3087d6c806546b6e2671575c98461e441f65542bd95de26d0f53a64e7848d7
   31d9608d053e8d345546602d86236ffe3704c98ad59144f3089e5e6d527b5497
   ba103c79d62e80d0235410b06f71a7d9bd1c38000f910d6312ea2f20a3557535
   ad01b3093fb5f7ee507080d0f77d48c9c3b3796f6b7dd3786085fb895123f04c
   a1f1c1be22c747a8dface32370fb0d570783e27dbb7e74fca94ee39676fde3d8
   a9553d878224736e37e191dab953c7e228c07ad5ca3122421c14debd072a9ab6
</pre><a href="#appendix-D.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-D.1-9">Alice derives the shared secret (SS) using KDF3 with SHA-256:<a href="#appendix-D.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1-10">
<pre>
   3cf82ec41b54ed4d37402bbd8f805a52
</pre><a href="#appendix-D.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="originator-cms-processing">
<section id="appendix-D.2">
        <h3 id="name-originator-cms-processing">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-originator-cms-processing" class="section-name selfRef">Originator CMS Processing</a>
        </h3>
<p id="appendix-D.2-1">Alice encodes the CMSORIforKEMOtherInfo structure with the algorithm
identifier for AES-128-KEYWRAP and a key length of 16 octets.
The DER encoding of CMSORIforKEMOtherInfo produces 18 octets:<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-2">
<pre>
   3010300b0609608648016503040105020110
</pre><a href="#appendix-D.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-3">The CMSORIforKEMOtherInfo structure contains:<a href="#appendix-D.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-D.2-4.1">
            <div class="alignLeft art-text artwork" id="appendix-D.2-4.1.1">
<pre>
  0  16: SEQUENCE {
  2  11:  SEQUENCE {
  4   9:   OBJECT IDENTIFIER aes128-wrap (2 16 840 1 101 3 4 1 5)
       :    }
 15   1:  INTEGER 16
       :   }
</pre><a href="#appendix-D.2-4.1.1" class="pilcrow">¶</a>
</div>
</li>
        </ul>
<p id="appendix-D.2-5">Alice derives the key-encryption key from shared secret produced
by RSA-KEM Encapsulate() and the CMSORIforKEMOtherInfo structure
with KDF3 and SHA-256, the KEK is:<a href="#appendix-D.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-6">
<pre>
   e6dc9d62ff2b469bef604c617b018718
</pre><a href="#appendix-D.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-7">Alice randomly generates a 128-bit content-encryption key:<a href="#appendix-D.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-8">
<pre>
   77f2a84640304be7bd42670a84a1258b
</pre><a href="#appendix-D.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-9">Alice uses AES-128-KEYWRAP to encrypt the 128-bit content-encryption
key with the derived key-encryption key:<a href="#appendix-D.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-10">
<pre>
   28782e5d3d794a7616b863fbcfc719b78f12de08cf286e09
</pre><a href="#appendix-D.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-11">Alice encrypts the padded content using AES-128-CBC with the
content-encryption key.  The 16-octet IV used is:<a href="#appendix-D.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-12">
<pre>
   480ccafebabefacedbaddecaf8887781
</pre><a href="#appendix-D.2-12" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-13">The padded content plaintext is:<a href="#appendix-D.2-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-14">
<pre>
   48656c6c6f2c20776f726c6421030303
</pre><a href="#appendix-D.2-14" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-15">The resulting ciphertext is:<a href="#appendix-D.2-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2-16">
<pre>
   c6ca65db7bdd76b0f37e2fab6264b66d
</pre><a href="#appendix-D.2-16" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2-17">Alice encodes the EnvelopedData (using KEMRecipientInfo) and
ContentInfo, and then sends the result to Bob.  The Base64-encoded
result is:<a href="#appendix-D.2-17" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-D.2-18.1">
            <div class="alignLeft art-text artwork" id="appendix-D.2-18.1.1">
<pre>
MIICXAYJKoZIhvcNAQcDoIICTTCCAkkCAQMxggIEpIICAAYLKoZIhvcNAQkQDQMw
ggHvAgEAgBSe62fJuVp01E0vFjlmgOgBtcuknDAJBgcogYxxAgIEBIIBgMBx/Cc6
+Oe9sVLga/czEDYQdBVKQ6vPPJPBNJnSBlNEPu2e9dPAaF5Kp2poVIFbuXaR/5+N
rBXup9dPRSvzUKZGFj1oKI6XjL96cwie5ScS+aT0ngas57vIWrFNTjNsl8VyiiZU
E4x7JuiDXGsKn77SZJXE6t90Wikzvig/aoixZpX8BmZoc8+202cY7zN2zvwQDDlB
88SUlEB4MlgHpVkYa5XMq/NxTPr3n4O9MFN/3ZrtWkzcvYvQSG+u1z6dSGswh9bI
BlRrbiZxV1yYRh5EH2VUK9ld4m0PU6ZOeEjXMdlgjQU+jTRVRmAthiNv/jcEyYrV
kUTzCJ5ebVJ7VJe6EDx51i6A0CNUELBvcafZvRw4AA+RDWMS6i8go1V1Na0Bswk/
tffuUHCA0Pd9SMnDs3lva33TeGCF+4lRI/BMofHBviLHR6jfrOMjcPsNVweD4n27
fnT8qU7jlnb949ipVT2HgiRzbjfhkdq5U8fiKMB61coxIkIcFN69ByqatjAbBgor
gQUQhkgJLAECMA0GCWCGSAFlAwQCAQUAAgEQMAsGCWCGSAFlAwQBBQQYKHguXT15
SnYWuGP7z8cZt48S3gjPKG4JMDwGCSqGSIb3DQEHATAdBglghkgBZQMEAQIEEEgM
yv66vvrO263eyviId4GAEMbKZdt73Xaw834vq2Jktm0=
</pre><a href="#appendix-D.2-18.1.1" class="pilcrow">¶</a>
</div>
</li>
        </ul>
<p id="appendix-D.2-19">This result decodes to:<a href="#appendix-D.2-19" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-D.2-20.1">
            <div class="alignLeft art-text artwork" id="appendix-D.2-20.1.1">
<pre>
  0 604: SEQUENCE {
  4   9:  OBJECT IDENTIFIER envelopedData (1 2 840 113549 1 7 3)
 15 589:  [0] {
 19 585:   SEQUENCE {
 23   1:    INTEGER 3
 26 516:    SET {
 30 512:     [4] {
 34  11:      OBJECT IDENTIFIER
       :       KEMRecipientInfo (1 2 840 113549 1 9 16 13 3)
 47 495:      SEQUENCE {
 51   1:       INTEGER 0
 54  20:       [0]
       :       9E EB 67 C9 B9 5A 74 D4 4D 2F 16 39 66 80 E8 01
       :       B5 CB A4 9C
 76   9:       SEQUENCE {
 78   7:        OBJECT IDENTIFIER kemRSA (1 0 18033 2 2 4)
       :         }
 87 384:       OCTET STRING
       :       C0 71 FC 27 3A F8 E7 BD B1 52 E0 6B F7 33 10 36
       :       10 74 15 4A 43 AB CF 3C 93 C1 34 99 D2 06 53 44
       :       3E ED 9E F5 D3 C0 68 5E 4A A7 6A 68 54 81 5B B9
       :       76 91 FF 9F 8D AC 15 EE A7 D7 4F 45 2B F3 50 A6
       :       46 16 3D 68 28 8E 97 8C BF 7A 73 08 9E E5 27 12
       :       F9 A4 F4 9E 06 AC E7 BB C8 5A B1 4D 4E 33 6C 97
       :       C5 72 8A 26 54 13 8C 7B 26 E8 83 5C 6B 0A 9F BE
       :       D2 64 95 C4 EA DF 74 5A 29 33 BE 28 3F 6A 88 B1
       :       66 95 FC 06 66 68 73 CF B6 D3 67 18 EF 33 76 CE
       :       FC 10 0C 39 41 F3 C4 94 94 40 78 32 58 07 A5 59
       :       18 6B 95 CC AB F3 71 4C FA F7 9F 83 BD 30 53 7F
       :       DD 9A ED 5A 4C DC BD 8B D0 48 6F AE D7 3E 9D 48
       :       6B 30 87 D6 C8 06 54 6B 6E 26 71 57 5C 98 46 1E
       :       44 1F 65 54 2B D9 5D E2 6D 0F 53 A6 4E 78 48 D7
       :       31 D9 60 8D 05 3E 8D 34 55 46 60 2D 86 23 6F FE
       :       37 04 C9 8A D5 91 44 F3 08 9E 5E 6D 52 7B 54 97
       :       BA 10 3C 79 D6 2E 80 D0 23 54 10 B0 6F 71 A7 D9
       :       BD 1C 38 00 0F 91 0D 63 12 EA 2F 20 A3 55 75 35
       :       AD 01 B3 09 3F B5 F7 EE 50 70 80 D0 F7 7D 48 C9
       :       C3 B3 79 6F 6B 7D D3 78 60 85 FB 89 51 23 F0 4C
       :       A1 F1 C1 BE 22 C7 47 A8 DF AC E3 23 70 FB 0D 57
       :       07 83 E2 7D BB 7E 74 FC A9 4E E3 96 76 FD E3 D8
       :       A9 55 3D 87 82 24 73 6E 37 E1 91 DA B9 53 C7 E2
       :       28 C0 7A D5 CA 31 22 42 1C 14 DE BD 07 2A 9A B6
475  27:       SEQUENCE {
477  10:        OBJECT IDENTIFIER
       :         kdf3 (1 3 133 16 840 9 44 1 2)
489  13:        SEQUENCE {
491   9:         OBJECT IDENTIFIER
       :          sha-256 (2 16 840 1 101 3 4 2 1)
502   0:         NULL
       :          }
       :         }
504   1:       INTEGER 16
507  11:       SEQUENCE {
509   9:        OBJECT IDENTIFIER
       :         aes128-wrap (2 16 840 1 101 3 4 1 5)
       :         }
520  24:       OCTET STRING
       :       28 78 2E 5D 3D 79 4A 76 16 B8 63 FB CF C7 19 B7
       :       8F 12 DE 08 CF 28 6E 09
       :        }
       :       }
       :      }
546  60:    SEQUENCE {
548   9:     OBJECT IDENTIFIER data (1 2 840 113549 1 7 1)
559  29:     SEQUENCE {
561   9:      OBJECT IDENTIFIER
       :       aes128-CBC (2 16 840 1 101 3 4 1 2)
572  16:      OCTET STRING
       :      48 0C CA FE BA BE FA CE DB AD DE CA F8 88 77 81
       :       }
590  16:     [0] C6 CA 65 DB 7B DD 76 B0 F3 7E 2F AB 62 64 B6 6D
       :      }
       :     }
       :    }
       :   }
</pre><a href="#appendix-D.2-20.1.1" class="pilcrow">¶</a>
</div>
</li>
        </ul>
</section>
</div>
<div id="recipient-rsa-kem-decapsulate-processing">
<section id="appendix-D.3">
        <h3 id="name-recipient-rsa-kem-decapsula">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-recipient-rsa-kem-decapsula" class="section-name selfRef">Recipient RSA-KEM Decapsulate() Processing</a>
        </h3>
<p id="appendix-D.3-1">Bob's private key:<a href="#appendix-D.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.3-2">
<pre>
   -----BEGIN PRIVATE KEY-----
   MIIG5AIBAAKCAYEA3ocW14cxncPJ47fnEjBZAyfC2lqapL3ET4jvV6C7gGeVrRQx
   WPDwl+cFYBBR2ej3j3/0ecDmu+XuVi2+s5JHKeeza+itfuhsz3yifgeEpeK8T+Su
   sHhn20/NBLhYKbh3kiAcCgQ56dpDrDvDcLqqvS3jg/VO+OPnZbofoHOOevt8Q/ro
   ahJe1PlIyQ4udWB8zZezJ4mLLfbOA9YVaYXx2AHHZJevo3nmRnlgJXo6mE00E/6q
   khjDHKSMdl2WG6mO9TCDZc9qY3cAJDU6Ir0vSH7qUl8/vN13y4UOFkn8hM4kmZ6b
   JqbZt5NbjHtY4uQ0VMW3RyESzhrO02mrp39auLNnH3EXdXaV1tk75H3qC7zJaeGW
   MJyQfOE3YfEGRKn8fxubji716D8UecAxAzFyFL6m1JiOyV5acAiOpxN14qRYZdHn
   XOM9DqGIGpoeY1UuD4Mo05osOqOUpBJHA9fSwhSZG7VNf+vgNWTLNYSYLI04KiMd
   ulnvU6ds+QPz+KKtAgMBAAECggGATFfkSkUjjJCjLvDk4aScpSx6+Rakf2hrdS3x
   jwqhyUfAXgTTeUQQBs1HVtHCgxQd+qlXYn3/qu8TeZVwG4NPztyi/Z5yB1wOGJEV
   3k8N/ytul6pJFFn6p48VM01bUdTrkMJbXERe6g/rr6dBQeeItCaOK7N5SIJH3Oqh
   9xYuB5tH4rquCdYLmt17Tx8CaVqU9qPY3vOdQEOwIjjMV8uQUR8rHSO9KkSj8AGs
   Lq9kcuPpvgJc2oqMRcNePS2WVh8xPFktRLLRazgLP8STHAtjT6SlJ2UzkUqfDHGK
   q/BoXxBDu6L1VDwdnIS5HXtL54ElcXWsoOyKF8/ilmhRUIUWRZFmlS1ok8IC5IgX
   UdL9rJVZFTRLyAwmcCEvRM1asbBrhyEyshSOuN5nHJi2WVJ+wSHijeKl1qeLlpMk
   HrdIYBq4Nz7/zXmiQphpAy+yQeanhP8O4O6C8e7RwKdpxe44su4Z8fEgA5yQx0u7
   8yR1EhGKydX5bhBLR5Cm1VM7rT2BAoHBAP/+e5gZLNf/ECtEBZjeiJ0VshszOoUq
   haUQPA+9Bx9pytsoKm5oQhB7QDaxAvrn8/FUW2aAkaXsaj9F+/q30AYSQtExai9J
   fdKKook3oimN8/yNRsKmhfjGOj8hd4+GjX0qoMSBCEVdT+bAjjry8wgQrqReuZnu
   oXU85dmb3jvv0uIczIKvTIeyjXE5afjQIJLmZFXsBm09BG87Ia5EFUKly96BOMJh
   /QWEzuYYXDqOFfzQtkAefXNFW21Kz4Hw2QKBwQDeiGh4lxCGTjECvG7fauMGlu+q
   DSdYyMHif6t6mx57eS16EjvOrlXKItYhIyzW8Kw0rf/CSB2j8ig1GkMLTOgrGIJ1
   0322o50FOr5oOmZPueeR4pOyAP0fgQ8DD1L3JBpY68/8MhYbsizVrR+Ar4jM0f96
   W2bF5Xj3h+fQTDMkx6VrCCQ6miRmBUzH+ZPs5n/lYOzAYrqiKOanaiHy4mjRvlsy
   mjZ6z5CG8sISqcLQ/k3Qli5pOY/v0rdBjgwAW/UCgcEAqGVYGjKdXCzuDvf9EpV4
   mpTWB6yIV2ckaPOn/tZi5BgsmEPwvZYZt0vMbu28Px7sSpkqUuBKbzJ4pcy8uC3I
   SuYiTAhMiHS4rxIBX3BYXSuDD2RD4vG1+XM0h6jVRHXHh0nOXdVfgnmigPGz3jVJ
   B8oph/jD8O2YCk4YCTDOXPEi8Rjusxzro+whvRR+kG0gsGGcKSVNCPj1fNISEte4
   gJId7O1mUAAzeDjn/VaS/PXQovEMolssPPKn9NocbKbpAoHBAJnFHJunl22W/lrr
   ppmPnIzjI30YVcYOA5vlqLKyGaAsnfYqP1WUNgfVhq2jRsrHx9cnHQI9Hu442PvI
   x+c5H30YFJ4ipE3eRRRmAUi4ghY5WgD+1hw8fqyUW7E7l5LbSbGEUVXtrkU5G64T
   UR91LEyMF8OPATdiV/KD4PWYkgaqRm3tVEuCVACDTQkqNsOOi3YPQcm270w6gxfQ
   SOEy/kdhCFexJFA8uZvmh6Cp2crczxyBilR/yCxqKOONqlFdOQKBwFbJk5eHPjJz
   AYueKMQESPGYCrwIqxgZGCxaqeVArHvKsEDx5whI6JWoFYVkFA8F0MyhukoEb/2x
   2qB5T88Dg3EbqjTiLg3qxrWJ2OxtUo8pBP2I2wbl2NOwzcbrlYhzEZ8bJyxZu5i1
   sYILC8PJ4Qzw6jS4Qpm4y1WHz8e/ElW6VyfmljZYA7f9WMntdfeQVqCVzNTvKn6f
   hg6GSpJTzp4LV3ougi9nQuWXZF2wInsXkLYpsiMbL6Fz34RwohJtYA==
   -----END PRIVATE KEY-----
</pre><a href="#appendix-D.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D.3-3">Bob checks that the length of the ciphertext is less than nLen bytes.<a href="#appendix-D.3-3" class="pilcrow">¶</a></p>
<p id="appendix-D.3-4">Bob checks that the ciphertext is greater than zero and is less
than his RSA modulus.<a href="#appendix-D.3-4" class="pilcrow">¶</a></p>
<p id="appendix-D.3-5">Bob decrypts the ciphertext with his RSA private key to obtain
the integer z:<a href="#appendix-D.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.3-6">
<pre>
   9c126102a5c1c0354672a3c2f19fc9ddea988f815e1da812c7bd4f8eb082bdd1
   4f85a7f7c2f1af11d5333e0d6bcb375bf855f208da72ba27e6fb0655f2825aa6
   2b93b1f9bbd3491fed58f0380fa0de36430e3a144d569600bd362609be5b9481
   0875990b614e406fa6dff500043cbca95968faba61f795096a7fb3687a51078c
   4ca2cb663366b0bea0cd9cccac72a25f3f4ed03deb68b4453bba44b943f4367b
   67d6cd10c8ace53f545aac50968fc3c6ecc80f3224b64e37038504e2d2c0e2b2
   9d45e46c62826d96331360e4c17ea3ef89a9efc5fac99eda830e81450b6534dc
   0bdf042b8f3b706649c631fe51fc2445cc8d447203ec2f41f79cdfea16de1ce6
   abdfdc1e2ef2e5d5d8a65e645f397240ef5a26f5e4ff715de782e30ecf477293
   e89e13171405909a8e04dd31d21d0c57935fc1ceea8e1033e31e1bc8c56da0f3
   d79510f3f380ff58e5a61d361f2f18e99fbae5663172e8cd1f21deaddc5bbbea
   060d55f1842b93d1a9c888d0bf85d0af9947fe51acf940c7e7577eb79cabecb3
</pre><a href="#appendix-D.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-D.3-7">Bob checks that the integer z is greater than zero and is less
than his RSA modulus.<a href="#appendix-D.3-7" class="pilcrow">¶</a></p>
<p id="appendix-D.3-8">Bob derives the shared secret (SS) using KDF3 with SHA-256:<a href="#appendix-D.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.3-9">
<pre>
   3cf82ec41b54ed4d37402bbd8f805a52
</pre><a href="#appendix-D.3-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="recipient-cms-processing">
<section id="appendix-D.4">
        <h3 id="name-recipient-cms-processing">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-recipient-cms-processing" class="section-name selfRef">Recipient CMS Processing</a>
        </h3>
<p id="appendix-D.4-1">Bob encodes the CMSORIforKEMOtherInfo structure with the algorithm
identifier for AES-128-KEYWRAP and a key length of 16 octets.
The DER encoding of CMSORIforKEMOtherInfo is not repeated here.<a href="#appendix-D.4-1" class="pilcrow">¶</a></p>
<p id="appendix-D.4-2">Bob derives the key-encryption key from shared secret and the
CMSORIforKEMOtherInfo structure with KDF3 and SHA-256, the KEK is:<a href="#appendix-D.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.4-3">
<pre>
   e6dc9d62ff2b469bef604c617b018718
</pre><a href="#appendix-D.4-3" class="pilcrow">¶</a>
</div>
<p id="appendix-D.4-4">Bob uses AES-KEY-WRAP to decrypt the content-encryption key
with the key-encryption key; the content-encryption key is:<a href="#appendix-D.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.4-5">
<pre>
   77f2a84640304be7bd42670a84a1258b
</pre><a href="#appendix-D.4-5" class="pilcrow">¶</a>
</div>
<p id="appendix-D.4-6">Bob decrypts the content using AES-128-CBC with the content-
encryption key.  The 16-octet IV used is:<a href="#appendix-D.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.4-7">
<pre>
   480ccafebabefacedbaddecaf8887781
</pre><a href="#appendix-D.4-7" class="pilcrow">¶</a>
</div>
<p id="appendix-D.4-8">The received ciphertext content is:<a href="#appendix-D.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.4-9">
<pre>
   c6ca65db7bdd76b0f37e2fab6264b66d
</pre><a href="#appendix-D.4-9" class="pilcrow">¶</a>
</div>
<p id="appendix-D.4-10">The resulting padded plaintext content is:<a href="#appendix-D.4-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.4-11">
<pre>
   48656c6c6f2c20776f726c6421030303
</pre><a href="#appendix-D.4-11" class="pilcrow">¶</a>
</div>
<p id="appendix-D.4-12">After stripping the AES-CBC padding, the plaintext content is:<a href="#appendix-D.4-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.4-13">
<pre>
   Hello, world!
</pre><a href="#appendix-D.4-13" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-E">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-E-1">We thank James Randall, Burt Kaliski, and John Brainard as the
original authors of <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span>; this document is based on their work.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">We thank the members of the ASC X9F1 working group for their
contributions to drafts of ANS X9.44, which led to <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span>.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">We thank Blake Ramsdell, Jim Schaad, Magnus Nystrom, Bob Griffin,
and John Linn for helping bring <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span> to fruition.<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<p id="appendix-E-4">We thank
Burt Kaliski,
Alex Railean,
Joe Mandel,
Mike Ounsworth,
Peter Campbell, and
Daniel Van Geest
for careful review and thoughtful comments that greatly improved this document.<a href="#appendix-E-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Russ Housley</span></div>
<div dir="auto" class="left"><span class="org">Vigil Security, LLC</span></div>
<div dir="auto" class="left"><span class="street-address">516 Dranesville Road</span></div>
<div dir="auto" class="left">
<span class="locality">Herndon, VA</span>,  <span class="postal-code">20170</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:housley@vigilsec.com" class="email">housley@vigilsec.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sean Turner</span></div>
<div dir="auto" class="left"><span class="org">sn3rd</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sean@sn3rd.com" class="email">sean@sn3rd.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
